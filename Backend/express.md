# Express JS
## best sources to study
- [chai aur code backend playlist](https://youtube.com/playlist?list=PLu71SKxNbfoBGh_8p_NS-ZAh6v7HhYqHW&si=ySch-0H1FKFLa6rS)

## generating hash code in terminal
```bash
    node
```
```bash
    require('crypto').randomBytes(64).toString('hex')
```

## using json web token (JWT)
```bash
    npm i jsonwebtoken
```
```bash
    import jwt from 'jsonwebtoken'
```
### signing the data
```bash
    const token = await jwt.sign(
            { username : "nandish" },
            process.env.JWT_SECRET_KEY,
            { expiresIn: "1d" }
        );
```

## cookie options
```bash
{
    httpOnly : true, //accessible only by webrequest
    secure : true, //https
    sameSite : 'None', //allows cross site cookies
    maxAge : 7 * 24 * 60 * 60 *1000 //max age of expiry of cookies
}
```





# Express setup
## initialize npm
initializing any directory into npm
```bash
    npm init -y
```

## changes in package.json
- add "type": "module",
- add "start" : "nodemon index.js" in scripts
- add any other scripts if necessary
```bash
    sed -i '/"main":/a\  "type": "module",' package.json
    sed -i '/"scripts": {/a\    "dev": "nodemon src/index.js",' package.json
```

## Dependencies
### Compulsory Dependencies
- express
- dotenv
- mongoose
- mongodb
- cookie-parser
- cors
- mongoose-aggregate-paginate-v2
- jsonwebtoken
- bcrypt
- cloudinary
- multer
```bash
    npm install express dotenv mongoose mongodb cookie-parser cors mongoose-aggregate-paginate-v2 jsonwebtoken bcrypt cloudinary multer
```
### Compulsory Developer Dependencies
- nodemon
- prettier

```bash
    npm install -D prettier nodemon
```

## Deploying Express on Vercel
- create the project
- add .env and .gitignore files
- upload the code to github repository
- create file 'vercel.json' in root and add the following document
```bash
// vercel.json
{
    "version": 2,
    "builds": [
        {
            "src": "index.js",
            "use": "@vercel/node"
        }
    ],
    "routes": [
        {
            "src": "/(.*)",
            "dest": "index.js"
        }
    ]
}
```
- open vercel website and import the github repository
- add environment variables

### file structure

### prettier
- add ' .prettierrc ' file and paste
```bash
{
  "trailingComma": "es5",
  "tabWidth": 4,
  "semi": true,
  "singleQuote": false,
  "printWidth": 80,
  "bracketSpacing": true,
  "arrowParens": "always",
  "endOfLine": "crlf"
}
```
- add ' .prettierignore ' to ignore files from prettier and paste
```bash
node_modules
npm-debug.log
.npm
.vercel
.turbo
cache
CODEOWNERS
/.vscode
/node_modules
./dist
*.env
.env
.env.*
.git
```
### .gitignore file
```bash
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
lerna-debug.log*
.pnpm-debug.log*

# Diagnostic reports (https://nodejs.org/api/report.html)
report.[0-9]*.[0-9]*.[0-9]*.[0-9]*.json

# Runtime data
pids
*.pid
*.seed
*.pid.lock

# Directory for instrumented libs generated by jscoverage/JSCover
lib-cov

# Coverage directory used by tools like istanbul
coverage
*.lcov

# nyc test coverage
.nyc_output

# Grunt intermediate storage (https://gruntjs.com/creating-plugins#storing-task-files)
.grunt

# Bower dependency directory (https://bower.io/)
bower_components

# node-waf configuration
.lock-wscript

# Compiled binary addons (https://nodejs.org/api/addons.html)
build/Release

# Dependency directories
node_modules/
jspm_packages/

# Snowpack dependency directory (https://snowpack.dev/)
web_modules/

# TypeScript cache
*.tsbuildinfo

# Optional npm cache directory
.npm

# Optional eslint cache
.eslintcache

# Microbundle cache
.rpt2_cache/
.rts2_cache_cjs/
.rts2_cache_es/
.rts2_cache_umd/

# Optional REPL history
.node_repl_history

# Output of 'npm pack'
*.tgz

# Yarn Integrity file
.yarn-integrity

# dotenv environment variables file
.env
.env.test
.env.production

# parcel-bundler cache (https://parceljs.org/)
.cache
.parcel-cache

# Next.js build output
.next
out

# Nuxt.js build / generate output
.nuxt
dist

# Gatsby files
.cache/
# Comment in the public line in if your project uses Gatsby and not Next.js
# https://nextjs.org/blog/next-9-1#public-directory-support
# public

# vuepress build output
.vuepress/dist

# Serverless directories
.serverless/

# FuseBox cache
.fusebox/

# DynamoDB Local files
.dynamodb/

# TernJS port file
.tern-port

# Stores VSCode versions used for testing VSCode extensions
.vscode-test

# yarn v2
.yarn/cache
.yarn/unplugged
.yarn/build-state.yml
.yarn/install-state.gz
.pnp.*

# End of https://mrkandreev.name/snippets/gitignore-generator/#Node
```
#### add .env file

## template for starter express app
```bash
git remote add starter https://github.com/NandishBS/express-starter-template.git
git pull starter main --allow-unrelated-histories --no-edit
mv .env.sample .env
git remote remove starter
npm init -y
sed -i '/"main":/a\  "type": "module",' package.json
sed -i '/"scripts": {/a\    "dev": "nodemon src/index.js",' package.json
npm install -D prettier nodemon
npm install express dotenv mongoose mongodb cookie-parser cors mongoose-aggregate-paginate-v2 jsonwebtoken bcrypt cloudinary multer
git add .
git commit -m 'express setup completed'
```

